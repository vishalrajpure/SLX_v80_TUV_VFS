<?xml version="1.0"?>
<QuickForm xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" id="a38f6dc7-bffa-4f13-bef2-dec173483310" DefinitionType="Sage.Platform.QuickForms.QuickFormMainDetailViewDefinition, Sage.Platform.QuickForms">
  <ActiveControl />
  <ImagePath />
  <LoadActions>
    <FormActionDefinition>
      <ResourceKey>e1e56126-cbba-4255-bc99-83385b4cda82</ResourceKey>
      <Action typeName="Sage.Platform.QuickForms.ActionItems.NoActionActionItem, Sage.Platform.QuickForms">
        <NoActionActionItem>
          <MethodName />
        </NoActionActionItem>
      </Action>
      <IsDialogCloseAction>False</IsDialogCloseAction>
      <RunOnEveryRePaint>False</RunOnEveryRePaint>
      <DialogActionResult>NoResult</DialogActionResult>
      <PerformsUpdate>False</PerformsUpdate>
      <AppliedSecurity />
      <RefreshData>False</RefreshData>
    </FormActionDefinition>
  </LoadActions>
  <Name>QuotationDetail</Name>
  <ClientScriptIncludes />
  <ClientResourceKeys />
  <ExtendedProperties />
  <HelpFile />
  <ReadOnly>false</ReadOnly>
  <GeneratePrintView>false</GeneratePrintView>
  <Controls>
    <Control typeName="Sage.Platform.QuickForms.Controls.QFTextBox, Sage.Platform.QuickForms">
      <QFTextBox>
        <Column>0</Column>
        <Row>0</Row>
        <IsReadOnly>true</IsReadOnly>
        <HotKey>0</HotKey>
        <TabIndex>0</TabIndex>
        <ControlId>QuotationNumber</ControlId>
        <DataBindings>
          <QuickFormPropertyDataBindingDefinition>
            <DataSourceID>MainEntity</DataSourceID>
            <DataItemName>QuotationNumber</DataItemName>
            <ControlItemName>Text</ControlItemName>
            <FormatString />
            <NullValueString />
          </QuickFormPropertyDataBindingDefinition>
        </DataBindings>
        <ControlLabelPlacement>left</ControlLabelPlacement>
        <ExtendedProperties />
        <CaptionAlignment>left</CaptionAlignment>
        <StyleScheme />
        <MaxLength>64</MaxLength>
        <OnChangeAction>
          <ResourceKey>QuotationNumber</ResourceKey>
          <Action typeName="Sage.Platform.QuickForms.ActionItems.NoActionActionItem, Sage.Platform.QuickForms">
            <NoActionActionItem>
              <MethodName />
            </NoActionActionItem>
          </Action>
          <IsDialogCloseAction>False</IsDialogCloseAction>
          <RunOnEveryRePaint>False</RunOnEveryRePaint>
          <DialogActionResult>NoResult</DialogActionResult>
          <PerformsUpdate>False</PerformsUpdate>
          <AppliedSecurity />
          <RefreshData>False</RefreshData>
        </OnChangeAction>
        <Required>false</Required>
      </QFTextBox>
    </Control>
    <Control typeName="Sage.Platform.QuickForms.Controls.QFTextBox, Sage.Platform.QuickForms">
      <QFTextBox>
        <Column>0</Column>
        <Row>1</Row>
        <HotKey>0</HotKey>
        <TabIndex>0</TabIndex>
        <ControlId>Quotation</ControlId>
        <DataBindings>
          <QuickFormPropertyDataBindingDefinition>
            <DataSourceID>MainEntity</DataSourceID>
            <DataItemName>DESCRIPTION</DataItemName>
            <ControlItemName>Text</ControlItemName>
            <FormatString />
            <NullValueString />
          </QuickFormPropertyDataBindingDefinition>
        </DataBindings>
        <ControlLabelPlacement>left</ControlLabelPlacement>
        <ExtendedProperties />
        <CaptionAlignment>left</CaptionAlignment>
        <StyleScheme />
        <MaxLength>64</MaxLength>
        <OnChangeAction>
          <ResourceKey>Quotation</ResourceKey>
          <Action typeName="Sage.Platform.QuickForms.ActionItems.NoActionActionItem, Sage.Platform.QuickForms">
            <NoActionActionItem>
              <MethodName />
            </NoActionActionItem>
          </Action>
          <IsDialogCloseAction>False</IsDialogCloseAction>
          <RunOnEveryRePaint>False</RunOnEveryRePaint>
          <DialogActionResult>NoResult</DialogActionResult>
          <PerformsUpdate>False</PerformsUpdate>
          <AppliedSecurity />
          <RefreshData>False</RefreshData>
        </OnChangeAction>
        <Required>false</Required>
      </QFTextBox>
    </Control>
    <Control typeName="Sage.SalesLogix.QuickForms.QFControls.QFSLXLookup, Sage.SalesLogix.QuickForms.QFControls">
      <QFSLXLookup>
        <Column>0</Column>
        <Row>2</Row>
        <HotKey>0</HotKey>
        <TabIndex>0</TabIndex>
        <ControlId>lkpAccountManager</ControlId>
        <DataBindings>
          <QuickFormPropertyDataBindingDefinition>
            <DataSourceID>MainEntity</DataSourceID>
            <DataItemName>ACCOUNTMANAGERID</DataItemName>
            <ControlItemName>LookupResultValue</ControlItemName>
            <FormatString />
            <NullValueString />
          </QuickFormPropertyDataBindingDefinition>
        </DataBindings>
        <ControlLabelPlacement>left</ControlLabelPlacement>
        <ExtendedProperties />
        <CaptionAlignment>left</CaptionAlignment>
        <StyleScheme />
        <OnChangeAction>
          <ResourceKey>lkpAccountManager</ResourceKey>
          <Action typeName="Sage.Platform.QuickForms.ActionItems.NoActionActionItem, Sage.Platform.QuickForms">
            <NoActionActionItem>
              <MethodName />
            </NoActionActionItem>
          </Action>
          <IsDialogCloseAction>False</IsDialogCloseAction>
          <RunOnEveryRePaint>False</RunOnEveryRePaint>
          <DialogActionResult>NoResult</DialogActionResult>
          <PerformsUpdate>False</PerformsUpdate>
          <AppliedSecurity />
          <RefreshData>False</RefreshData>
        </OnChangeAction>
        <Required>false</Required>
        <LookupImage />
        <LookupDialogWidth xsi:nil="true" />
        <LookupDialogHeight xsi:nil="true" />
        <LookupBindingMode>String</LookupBindingMode>
        <LookupResultValue xsi:type="xsd:string" />
        <SeedProperty />
        <SeedValue />
        <DropDownDisplayProperty />
        <AllowClearingResult>false</AllowClearingResult>
        <AppendStringValues>false</AppendStringValues>
        <OverrideSeedOnSearch>false</OverrideSeedOnSearch>
        <LookupEntityName>UserInfo</LookupEntityName>
        <LookupEntityTypeName>Sage.Entity.Interfaces.IUserInfo, Sage.Entity.Interfaces, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null</LookupEntityTypeName>
        <AutoPostBack>false</AutoPostBack>
        <EnableHyperLinking>false</EnableHyperLinking>
        <InitializeLookup>false</InitializeLookup>
        <LookupProperties>
          <LookupProperty>
            <PropertyName>Division</PropertyName>
            <PropertyType>System.String</PropertyType>
            <PropertyHeader>Division</PropertyHeader>
            <PropertyFormat>None</PropertyFormat>
            <PropertyFormatString />
            <UseAsResult>true</UseAsResult>
            <ExcludeFromFilters>false</ExcludeFromFilters>
            <IsSortable>true</IsSortable>
            <HideCondition />
          </LookupProperty>
          <LookupProperty>
            <PropertyName>Email</PropertyName>
            <PropertyType>System.String</PropertyType>
            <PropertyHeader>Email</PropertyHeader>
            <PropertyFormat>None</PropertyFormat>
            <PropertyFormatString />
            <UseAsResult>true</UseAsResult>
            <ExcludeFromFilters>false</ExcludeFromFilters>
            <IsSortable>true</IsSortable>
            <HideCondition />
          </LookupProperty>
          <LookupProperty>
            <PropertyName>Mobile</PropertyName>
            <PropertyType>System.String</PropertyType>
            <PropertyHeader>Mobile</PropertyHeader>
            <PropertyFormat>None</PropertyFormat>
            <PropertyFormatString />
            <UseAsResult>true</UseAsResult>
            <ExcludeFromFilters>false</ExcludeFromFilters>
            <IsSortable>true</IsSortable>
            <HideCondition />
          </LookupProperty>
          <LookupProperty>
            <PropertyName>UserName</PropertyName>
            <PropertyType>System.String</PropertyType>
            <PropertyHeader>UserName (User Name)</PropertyHeader>
            <PropertyFormat>None</PropertyFormat>
            <PropertyFormatString />
            <UseAsResult>true</UseAsResult>
            <ExcludeFromFilters>false</ExcludeFromFilters>
            <IsSortable>true</IsSortable>
            <HideCondition />
          </LookupProperty>
        </LookupProperties>
        <LookupPreFilters />
      </QFSLXLookup>
    </Control>
    <Control typeName="Sage.SalesLogix.QuickForms.QFControls.QFSLXLookup, Sage.SalesLogix.QuickForms.QFControls">
      <QFSLXLookup>
        <Column>0</Column>
        <Row>3</Row>
        <HotKey>0</HotKey>
        <TabIndex>0</TabIndex>
        <ControlId>lkpEndCustomer</ControlId>
        <DataBindings>
          <QuickFormPropertyDataBindingDefinition>
            <DataSourceID>MainEntity</DataSourceID>
            <DataItemName>ENDCUSTOMER</DataItemName>
            <ControlItemName>LookupResultValue</ControlItemName>
            <FormatString />
            <NullValueString />
          </QuickFormPropertyDataBindingDefinition>
        </DataBindings>
        <ControlLabelPlacement>left</ControlLabelPlacement>
        <ExtendedProperties />
        <CaptionAlignment>left</CaptionAlignment>
        <StyleScheme />
        <OnChangeAction>
          <ResourceKey>lkpEndCustomer</ResourceKey>
          <Action typeName="Sage.Platform.QuickForms.ActionItems.NoActionActionItem, Sage.Platform.QuickForms">
            <NoActionActionItem>
              <MethodName />
            </NoActionActionItem>
          </Action>
          <IsDialogCloseAction>False</IsDialogCloseAction>
          <RunOnEveryRePaint>False</RunOnEveryRePaint>
          <DialogActionResult>NoResult</DialogActionResult>
          <PerformsUpdate>False</PerformsUpdate>
          <AppliedSecurity />
          <RefreshData>False</RefreshData>
        </OnChangeAction>
        <Required>false</Required>
        <LookupImage />
        <LookupDialogWidth xsi:nil="true" />
        <LookupDialogHeight xsi:nil="true" />
        <LookupBindingMode>String</LookupBindingMode>
        <LookupResultValue xsi:type="xsd:string" />
        <SeedProperty />
        <SeedValue />
        <DropDownDisplayProperty />
        <AllowClearingResult>false</AllowClearingResult>
        <AppendStringValues>false</AppendStringValues>
        <OverrideSeedOnSearch>false</OverrideSeedOnSearch>
        <LookupEntityName>Account</LookupEntityName>
        <LookupEntityTypeName>Sage.Entity.Interfaces.IAccount, Sage.Entity.Interfaces, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null</LookupEntityTypeName>
        <AutoPostBack>false</AutoPostBack>
        <EnableHyperLinking>false</EnableHyperLinking>
        <InitializeLookup>false</InitializeLookup>
        <LookupProperties>
          <LookupProperty>
            <PropertyName>AccountName</PropertyName>
            <PropertyType>System.String</PropertyType>
            <PropertyHeader>AccountName (Account Name)</PropertyHeader>
            <PropertyFormat>None</PropertyFormat>
            <PropertyFormatString />
            <UseAsResult>true</UseAsResult>
            <ExcludeFromFilters>false</ExcludeFromFilters>
            <IsSortable>true</IsSortable>
            <HideCondition />
          </LookupProperty>
          <LookupProperty>
            <PropertyName>Description</PropertyName>
            <PropertyType>System.String</PropertyType>
            <PropertyHeader>Description</PropertyHeader>
            <PropertyFormat>None</PropertyFormat>
            <PropertyFormatString />
            <UseAsResult>true</UseAsResult>
            <ExcludeFromFilters>false</ExcludeFromFilters>
            <IsSortable>true</IsSortable>
            <HideCondition />
          </LookupProperty>
          <LookupProperty>
            <PropertyName>Division</PropertyName>
            <PropertyType>System.String</PropertyType>
            <PropertyHeader>Division</PropertyHeader>
            <PropertyFormat>None</PropertyFormat>
            <PropertyFormatString />
            <UseAsResult>true</UseAsResult>
            <ExcludeFromFilters>false</ExcludeFromFilters>
            <IsSortable>true</IsSortable>
            <HideCondition />
          </LookupProperty>
          <LookupProperty>
            <PropertyName>Industry</PropertyName>
            <PropertyType>System.String</PropertyType>
            <PropertyHeader>Industry</PropertyHeader>
            <PropertyFormat>None</PropertyFormat>
            <PropertyFormatString />
            <UseAsResult>true</UseAsResult>
            <ExcludeFromFilters>false</ExcludeFromFilters>
            <IsSortable>true</IsSortable>
            <HideCondition />
          </LookupProperty>
        </LookupProperties>
        <LookupPreFilters />
      </QFSLXLookup>
    </Control>
    <Control typeName="Sage.SalesLogix.QuickForms.QFControls.QFDateTimePicker, Sage.SalesLogix.QuickForms.QFControls">
      <QFDateTimePicker>
        <Column>0</Column>
        <Row>4</Row>
        <HotKey>0</HotKey>
        <TabIndex>0</TabIndex>
        <ControlId>dtInspectionStartDate</ControlId>
        <DataBindings>
          <QuickFormPropertyDataBindingDefinition>
            <DataSourceID>MainEntity</DataSourceID>
            <DataItemName>INSPECTIONSTARTDATE</DataItemName>
            <ControlItemName>DateTimeValue</ControlItemName>
            <FormatString />
            <NullValueString />
          </QuickFormPropertyDataBindingDefinition>
        </DataBindings>
        <ControlLabelPlacement>left</ControlLabelPlacement>
        <ExtendedProperties />
        <CaptionAlignment>left</CaptionAlignment>
        <StyleScheme />
        <OnChangeAction>
          <ResourceKey>dtInspectionStartDate</ResourceKey>
          <Action typeName="Sage.Platform.QuickForms.ActionItems.NoActionActionItem, Sage.Platform.QuickForms">
            <NoActionActionItem>
              <MethodName />
            </NoActionActionItem>
          </Action>
          <IsDialogCloseAction>False</IsDialogCloseAction>
          <RunOnEveryRePaint>False</RunOnEveryRePaint>
          <DialogActionResult>NoResult</DialogActionResult>
          <PerformsUpdate>False</PerformsUpdate>
          <AppliedSecurity />
          <RefreshData>False</RefreshData>
        </OnChangeAction>
        <Required>false</Required>
        <DateTimeValue xsi:nil="true" />
        <SelectedDateTime>0001-01-01T00:00:00</SelectedDateTime>
        <DateOnly>true</DateOnly>
        <DisplayTime>false</DisplayTime>
        <BoundFieldType>DateTime</BoundFieldType>
        <AutoPostBack>false</AutoPostBack>
        <Timeless>false</Timeless>
      </QFDateTimePicker>
    </Control>
    <Control typeName="Sage.SalesLogix.QuickForms.QFControls.QFSLXPickList, Sage.SalesLogix.QuickForms.QFControls">
      <QFSLXPickList>
        <Column>0</Column>
        <Row>5</Row>
        <HotKey>0</HotKey>
        <TabIndex>0</TabIndex>
        <ControlId>pklFeeType</ControlId>
        <DataBindings>
          <QuickFormPropertyDataBindingDefinition>
            <DataSourceID>MainEntity</DataSourceID>
            <DataItemName>FEETYPE</DataItemName>
            <ControlItemName>PickListValue</ControlItemName>
            <FormatString />
            <NullValueString />
          </QuickFormPropertyDataBindingDefinition>
        </DataBindings>
        <ControlLabelPlacement>left</ControlLabelPlacement>
        <ExtendedProperties />
        <CaptionAlignment>left</CaptionAlignment>
        <StyleScheme />
        <MaxLength>64</MaxLength>
        <OnChangeAction>
          <ResourceKey>pklFeeType</ResourceKey>
          <Action typeName="Sage.Platform.QuickForms.ActionItems.NoActionActionItem, Sage.Platform.QuickForms">
            <NoActionActionItem>
              <MethodName />
            </NoActionActionItem>
          </Action>
          <IsDialogCloseAction>False</IsDialogCloseAction>
          <RunOnEveryRePaint>False</RunOnEveryRePaint>
          <DialogActionResult>NoResult</DialogActionResult>
          <PerformsUpdate>False</PerformsUpdate>
          <AppliedSecurity />
          <RefreshData>False</RefreshData>
        </OnChangeAction>
        <Required>false</Required>
        <AutoPostBack>false</AutoPostBack>
        <PickListName>FeeType</PickListName>
        <StorageMode>Text</StorageMode>
        <NameFormatString />
        <AllowMultiples>false</AllowMultiples>
        <AlphaSort>false</AlphaSort>
        <MustExistInList>true</MustExistInList>
        <NoneEditable>false</NoneEditable>
        <PickListId />
        <ValueStoredAsText>true</ValueStoredAsText>
      </QFSLXPickList>
    </Control>
    <Control typeName="Sage.Platform.QuickForms.Controls.QFTextBox, Sage.Platform.QuickForms">
      <QFTextBox>
        <Column>0</Column>
        <Row>6</Row>
        <HotKey>0</HotKey>
        <TabIndex>0</TabIndex>
        <ControlId>REFERENCENO</ControlId>
        <DataBindings>
          <QuickFormPropertyDataBindingDefinition>
            <DataSourceID>MainEntity</DataSourceID>
            <DataItemName>REFERENCENO</DataItemName>
            <ControlItemName>Text</ControlItemName>
            <FormatString />
            <NullValueString />
          </QuickFormPropertyDataBindingDefinition>
        </DataBindings>
        <ControlLabelPlacement>left</ControlLabelPlacement>
        <ExtendedProperties />
        <CaptionAlignment>left</CaptionAlignment>
        <StyleScheme />
        <MaxLength>64</MaxLength>
        <OnChangeAction>
          <ResourceKey>REFERENCENO</ResourceKey>
          <Action typeName="Sage.Platform.QuickForms.ActionItems.NoActionActionItem, Sage.Platform.QuickForms">
            <NoActionActionItem>
              <MethodName />
            </NoActionActionItem>
          </Action>
          <IsDialogCloseAction>False</IsDialogCloseAction>
          <RunOnEveryRePaint>False</RunOnEveryRePaint>
          <DialogActionResult>NoResult</DialogActionResult>
          <PerformsUpdate>False</PerformsUpdate>
          <AppliedSecurity />
          <RefreshData>False</RefreshData>
        </OnChangeAction>
        <Required>false</Required>
      </QFTextBox>
    </Control>
    <Control typeName="Sage.Platform.QuickForms.Controls.QFTextBox, Sage.Platform.QuickForms">
      <QFTextBox>
        <Column>0</Column>
        <Row>7</Row>
        <HotKey>0</HotKey>
        <TabIndex>0</TabIndex>
        <ControlId>pklCloseProbability</ControlId>
        <DataBindings>
          <QuickFormPropertyDataBindingDefinition>
            <DataSourceID>MainEntity</DataSourceID>
            <DataItemName>CLOSEPROBABILITY</DataItemName>
            <ControlItemName>Text</ControlItemName>
            <FormatString />
            <NullValueString />
          </QuickFormPropertyDataBindingDefinition>
        </DataBindings>
        <ControlLabelPlacement>left</ControlLabelPlacement>
        <ExtendedProperties />
        <CaptionAlignment>left</CaptionAlignment>
        <StyleScheme />
        <OnChangeAction>
          <ResourceKey>pklCloseProbability</ResourceKey>
          <Action typeName="Sage.Platform.QuickForms.ActionItems.NoActionActionItem, Sage.Platform.QuickForms">
            <NoActionActionItem>
              <MethodName />
            </NoActionActionItem>
          </Action>
          <IsDialogCloseAction>False</IsDialogCloseAction>
          <RunOnEveryRePaint>False</RunOnEveryRePaint>
          <DialogActionResult>NoResult</DialogActionResult>
          <PerformsUpdate>False</PerformsUpdate>
          <AppliedSecurity />
          <RefreshData>False</RefreshData>
        </OnChangeAction>
        <Required>false</Required>
      </QFTextBox>
    </Control>
    <Control typeName="Sage.Platform.QuickForms.QFControls.QFCheckBox, Sage.Platform.QuickForms.QFControls">
      <QFCheckBox>
        <Column>0</Column>
        <Row>8</Row>
        <HotKey>0</HotKey>
        <TabIndex>0</TabIndex>
        <ControlId>chkAddToForecast</ControlId>
        <DataBindings>
          <QuickFormPropertyDataBindingDefinition>
            <DataSourceID>MainEntity</DataSourceID>
            <DataItemName>ADDTOFORECAST</DataItemName>
            <ControlItemName>Checked</ControlItemName>
            <FormatString />
            <NullValueString />
          </QuickFormPropertyDataBindingDefinition>
        </DataBindings>
        <ControlLabelPlacement>left</ControlLabelPlacement>
        <ExtendedProperties />
        <CaptionAlignment>left</CaptionAlignment>
        <StyleScheme />
        <Checked>false</Checked>
        <OnChangeAction>
          <ResourceKey>chkAddToForecast</ResourceKey>
          <Action typeName="Sage.Platform.QuickForms.ActionItems.NoActionActionItem, Sage.Platform.QuickForms">
            <NoActionActionItem>
              <MethodName />
            </NoActionActionItem>
          </Action>
          <IsDialogCloseAction>False</IsDialogCloseAction>
          <RunOnEveryRePaint>False</RunOnEveryRePaint>
          <DialogActionResult>NoResult</DialogActionResult>
          <PerformsUpdate>False</PerformsUpdate>
          <AppliedSecurity />
          <RefreshData>False</RefreshData>
        </OnChangeAction>
      </QFCheckBox>
    </Control>
    <Control typeName="Sage.Platform.QuickForms.Controls.QFTextBox, Sage.Platform.QuickForms">
      <QFTextBox>
        <ColumnSpan>2</ColumnSpan>
        <Column>0</Column>
        <Row>9</Row>
        <HotKey>0</HotKey>
        <TabIndex>0</TabIndex>
        <ControlId>Notes</ControlId>
        <DataBindings>
          <QuickFormPropertyDataBindingDefinition>
            <DataSourceID>MainEntity</DataSourceID>
            <DataItemName>NOTES</DataItemName>
            <ControlItemName>Text</ControlItemName>
            <FormatString />
            <NullValueString />
          </QuickFormPropertyDataBindingDefinition>
        </DataBindings>
        <ControlLabelPlacement>left</ControlLabelPlacement>
        <ExtendedProperties />
        <CaptionAlignment>left</CaptionAlignment>
        <StyleScheme />
        <MaxLength>2147483647</MaxLength>
        <OnChangeAction>
          <ResourceKey>Notes</ResourceKey>
          <Action typeName="Sage.Platform.QuickForms.ActionItems.NoActionActionItem, Sage.Platform.QuickForms">
            <NoActionActionItem>
              <MethodName />
            </NoActionActionItem>
          </Action>
          <IsDialogCloseAction>False</IsDialogCloseAction>
          <RunOnEveryRePaint>False</RunOnEveryRePaint>
          <DialogActionResult>NoResult</DialogActionResult>
          <PerformsUpdate>False</PerformsUpdate>
          <AppliedSecurity />
          <RefreshData>False</RefreshData>
        </OnChangeAction>
        <Required>false</Required>
      </QFTextBox>
    </Control>
    <Control typeName="Sage.SalesLogix.QuickForms.QFControls.QFSLXLookup, Sage.SalesLogix.QuickForms.QFControls">
      <QFSLXLookup>
        <Column>1</Column>
        <Row>0</Row>
        <HotKey>0</HotKey>
        <TabIndex>0</TabIndex>
        <ControlId>QFTextBox</ControlId>
        <DataBindings>
          <QuickFormPropertyDataBindingDefinition>
            <DataSourceID>MainEntity</DataSourceID>
            <DataItemName>Opportunity</DataItemName>
            <ControlItemName>LookupResultValue</ControlItemName>
            <FormatString />
            <NullValueString />
          </QuickFormPropertyDataBindingDefinition>
        </DataBindings>
        <ControlLabelPlacement>left</ControlLabelPlacement>
        <ExtendedProperties />
        <CaptionAlignment>left</CaptionAlignment>
        <StyleScheme />
        <OnChangeAction>
          <ResourceKey>QFTextBox</ResourceKey>
          <Action typeName="Sage.Platform.QuickForms.ActionItems.NoActionActionItem, Sage.Platform.QuickForms">
            <NoActionActionItem>
              <MethodName />
            </NoActionActionItem>
          </Action>
          <IsDialogCloseAction>False</IsDialogCloseAction>
          <RunOnEveryRePaint>False</RunOnEveryRePaint>
          <DialogActionResult>NoResult</DialogActionResult>
          <PerformsUpdate>False</PerformsUpdate>
          <AppliedSecurity />
          <RefreshData>False</RefreshData>
        </OnChangeAction>
        <Required>false</Required>
        <LookupImage />
        <LookupDialogWidth xsi:nil="true" />
        <LookupDialogHeight xsi:nil="true" />
        <LookupBindingMode>Object</LookupBindingMode>
        <LookupResultValue xsi:type="xsd:string" />
        <SeedProperty />
        <SeedValue />
        <DropDownDisplayProperty />
        <AllowClearingResult>false</AllowClearingResult>
        <AppendStringValues>false</AppendStringValues>
        <OverrideSeedOnSearch>false</OverrideSeedOnSearch>
        <LookupEntityName>Opportunity</LookupEntityName>
        <LookupEntityTypeName>Sage.Entity.Interfaces.IOpportunity, Sage.Entity.Interfaces, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null</LookupEntityTypeName>
        <AutoPostBack>false</AutoPostBack>
        <EnableHyperLinking>true</EnableHyperLinking>
        <InitializeLookup>false</InitializeLookup>
        <LookupProperties>
          <LookupProperty>
            <PropertyName>Description</PropertyName>
            <PropertyType>System.String</PropertyType>
            <PropertyHeader>Description</PropertyHeader>
            <PropertyFormat>None</PropertyFormat>
            <PropertyFormatString />
            <UseAsResult>true</UseAsResult>
            <ExcludeFromFilters>false</ExcludeFromFilters>
            <IsSortable>true</IsSortable>
            <HideCondition />
          </LookupProperty>
          <LookupProperty>
            <PropertyName>Status</PropertyName>
            <PropertyType>System.String</PropertyType>
            <PropertyHeader>Status</PropertyHeader>
            <PropertyFormat>None</PropertyFormat>
            <PropertyFormatString />
            <UseAsResult>true</UseAsResult>
            <ExcludeFromFilters>false</ExcludeFromFilters>
            <IsSortable>true</IsSortable>
            <HideCondition />
          </LookupProperty>
          <LookupProperty>
            <PropertyName>Type</PropertyName>
            <PropertyType>System.String</PropertyType>
            <PropertyHeader>Type</PropertyHeader>
            <PropertyFormat>None</PropertyFormat>
            <PropertyFormatString />
            <UseAsResult>true</UseAsResult>
            <ExcludeFromFilters>false</ExcludeFromFilters>
            <IsSortable>true</IsSortable>
            <HideCondition />
          </LookupProperty>
        </LookupProperties>
        <LookupPreFilters />
      </QFSLXLookup>
    </Control>
    <Control typeName="Sage.SalesLogix.QuickForms.QFControls.QFSLXLookup, Sage.SalesLogix.QuickForms.QFControls">
      <QFSLXLookup>
        <Column>1</Column>
        <Row>1</Row>
        <HotKey>0</HotKey>
        <TabIndex>0</TabIndex>
        <ControlId>lkpAccount</ControlId>
        <DataBindings>
          <QuickFormPropertyDataBindingDefinition>
            <DataSourceID>MainEntity</DataSourceID>
            <DataItemName>ACCOUNTID</DataItemName>
            <ControlItemName>LookupResultValue</ControlItemName>
            <FormatString />
            <NullValueString />
          </QuickFormPropertyDataBindingDefinition>
        </DataBindings>
        <ControlLabelPlacement>left</ControlLabelPlacement>
        <ExtendedProperties />
        <CaptionAlignment>left</CaptionAlignment>
        <StyleScheme />
        <OnChangeAction>
          <ResourceKey>lkpAccount</ResourceKey>
          <Action typeName="Sage.Platform.QuickForms.ActionItems.NoActionActionItem, Sage.Platform.QuickForms">
            <NoActionActionItem>
              <MethodName />
            </NoActionActionItem>
          </Action>
          <IsDialogCloseAction>False</IsDialogCloseAction>
          <RunOnEveryRePaint>False</RunOnEveryRePaint>
          <DialogActionResult>NoResult</DialogActionResult>
          <PerformsUpdate>False</PerformsUpdate>
          <AppliedSecurity />
          <RefreshData>False</RefreshData>
        </OnChangeAction>
        <Required>false</Required>
        <LookupImage />
        <LookupDialogWidth xsi:nil="true" />
        <LookupDialogHeight xsi:nil="true" />
        <LookupBindingMode>String</LookupBindingMode>
        <LookupResultValue xsi:type="xsd:string" />
        <SeedProperty />
        <SeedValue />
        <DropDownDisplayProperty />
        <AllowClearingResult>false</AllowClearingResult>
        <AppendStringValues>false</AppendStringValues>
        <OverrideSeedOnSearch>false</OverrideSeedOnSearch>
        <LookupEntityName>Account</LookupEntityName>
        <LookupEntityTypeName>Sage.Entity.Interfaces.IAccount, Sage.Entity.Interfaces, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null</LookupEntityTypeName>
        <AutoPostBack>false</AutoPostBack>
        <EnableHyperLinking>false</EnableHyperLinking>
        <InitializeLookup>false</InitializeLookup>
        <LookupProperties>
          <LookupProperty>
            <PropertyName>AccountName</PropertyName>
            <PropertyType>System.String</PropertyType>
            <PropertyHeader>AccountName (Account Name)</PropertyHeader>
            <PropertyFormat>None</PropertyFormat>
            <PropertyFormatString />
            <UseAsResult>true</UseAsResult>
            <ExcludeFromFilters>false</ExcludeFromFilters>
            <IsSortable>true</IsSortable>
            <HideCondition />
          </LookupProperty>
          <LookupProperty>
            <PropertyName>Division</PropertyName>
            <PropertyType>System.String</PropertyType>
            <PropertyHeader>Division</PropertyHeader>
            <PropertyFormat>None</PropertyFormat>
            <PropertyFormatString />
            <UseAsResult>true</UseAsResult>
            <ExcludeFromFilters>false</ExcludeFromFilters>
            <IsSortable>true</IsSortable>
            <HideCondition />
          </LookupProperty>
          <LookupProperty>
            <PropertyName>Industry</PropertyName>
            <PropertyType>System.String</PropertyType>
            <PropertyHeader>Industry</PropertyHeader>
            <PropertyFormat>None</PropertyFormat>
            <PropertyFormatString />
            <UseAsResult>true</UseAsResult>
            <ExcludeFromFilters>false</ExcludeFromFilters>
            <IsSortable>true</IsSortable>
            <HideCondition />
          </LookupProperty>
        </LookupProperties>
        <LookupPreFilters />
      </QFSLXLookup>
    </Control>
    <Control typeName="Sage.SalesLogix.QuickForms.QFControls.QFSLXLookup, Sage.SalesLogix.QuickForms.QFControls">
      <QFSLXLookup>
        <Column>1</Column>
        <Row>2</Row>
        <IsReadOnly>true</IsReadOnly>
        <HotKey>0</HotKey>
        <TabIndex>0</TabIndex>
        <ControlId>lkpBranch</ControlId>
        <DataBindings>
          <QuickFormPropertyDataBindingDefinition>
            <DataSourceID>MainEntity</DataSourceID>
            <DataItemName>BRANCHID</DataItemName>
            <ControlItemName>LookupResultValue</ControlItemName>
            <FormatString />
            <NullValueString />
          </QuickFormPropertyDataBindingDefinition>
        </DataBindings>
        <ControlLabelPlacement>left</ControlLabelPlacement>
        <ExtendedProperties />
        <CaptionAlignment>left</CaptionAlignment>
        <StyleScheme />
        <OnChangeAction>
          <ResourceKey>lkpBranch</ResourceKey>
          <Action typeName="Sage.Platform.QuickForms.ActionItems.NoActionActionItem, Sage.Platform.QuickForms">
            <NoActionActionItem>
              <MethodName />
            </NoActionActionItem>
          </Action>
          <IsDialogCloseAction>False</IsDialogCloseAction>
          <RunOnEveryRePaint>False</RunOnEveryRePaint>
          <DialogActionResult>NoResult</DialogActionResult>
          <PerformsUpdate>False</PerformsUpdate>
          <AppliedSecurity />
          <RefreshData>False</RefreshData>
        </OnChangeAction>
        <Required>false</Required>
        <LookupImage />
        <LookupDialogWidth xsi:nil="true" />
        <LookupDialogHeight xsi:nil="true" />
        <LookupDisplayMode>DropDownList</LookupDisplayMode>
        <LookupBindingMode>String</LookupBindingMode>
        <LookupResultValue xsi:type="xsd:string" />
        <SeedProperty />
        <SeedValue />
        <DropDownDisplayProperty>BranchName</DropDownDisplayProperty>
        <AllowClearingResult>false</AllowClearingResult>
        <AppendStringValues>false</AppendStringValues>
        <OverrideSeedOnSearch>false</OverrideSeedOnSearch>
        <LookupEntityName>Branch</LookupEntityName>
        <LookupEntityTypeName>Sage.Entity.Interfaces.IBranch, Sage.Entity.Interfaces, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null</LookupEntityTypeName>
        <AutoPostBack>false</AutoPostBack>
        <EnableHyperLinking>false</EnableHyperLinking>
        <InitializeLookup>false</InitializeLookup>
        <LookupProperties />
        <LookupPreFilters />
      </QFSLXLookup>
    </Control>
    <Control typeName="Sage.SalesLogix.QuickForms.QFControls.QFSLXPickList, Sage.SalesLogix.QuickForms.QFControls">
      <QFSLXPickList>
        <Column>1</Column>
        <Row>3</Row>
        <IsReadOnly>true</IsReadOnly>
        <HotKey>0</HotKey>
        <TabIndex>0</TabIndex>
        <ControlId>pklType</ControlId>
        <DataBindings>
          <QuickFormPropertyDataBindingDefinition>
            <DataSourceID>MainEntity</DataSourceID>
            <DataItemName>TYPE</DataItemName>
            <ControlItemName>PickListValue</ControlItemName>
            <FormatString />
            <NullValueString />
          </QuickFormPropertyDataBindingDefinition>
        </DataBindings>
        <ControlLabelPlacement>left</ControlLabelPlacement>
        <ExtendedProperties />
        <CaptionAlignment>left</CaptionAlignment>
        <StyleScheme />
        <MaxLength>64</MaxLength>
        <OnChangeAction>
          <ResourceKey>pklType</ResourceKey>
          <Action typeName="Sage.Platform.QuickForms.ActionItems.NoActionActionItem, Sage.Platform.QuickForms">
            <NoActionActionItem>
              <MethodName />
            </NoActionActionItem>
          </Action>
          <IsDialogCloseAction>False</IsDialogCloseAction>
          <RunOnEveryRePaint>False</RunOnEveryRePaint>
          <DialogActionResult>NoResult</DialogActionResult>
          <PerformsUpdate>False</PerformsUpdate>
          <AppliedSecurity />
          <RefreshData>False</RefreshData>
        </OnChangeAction>
        <Required>false</Required>
        <AutoPostBack>false</AutoPostBack>
        <PickListName>TypeProduct</PickListName>
        <StorageMode>Text</StorageMode>
        <NameFormatString />
        <AllowMultiples>false</AllowMultiples>
        <AlphaSort>false</AlphaSort>
        <MustExistInList>true</MustExistInList>
        <NoneEditable>false</NoneEditable>
        <PickListId />
        <ValueStoredAsText>true</ValueStoredAsText>
      </QFSLXPickList>
    </Control>
    <Control typeName="Sage.SalesLogix.QuickForms.QFControls.QFDateTimePicker, Sage.SalesLogix.QuickForms.QFControls">
      <QFDateTimePicker>
        <Column>1</Column>
        <Row>4</Row>
        <HotKey>0</HotKey>
        <TabIndex>0</TabIndex>
        <ControlId>dtInspectionEndDate</ControlId>
        <DataBindings>
          <QuickFormPropertyDataBindingDefinition>
            <DataSourceID>MainEntity</DataSourceID>
            <DataItemName>INSPECTIONENDDATE</DataItemName>
            <ControlItemName>DateTimeValue</ControlItemName>
            <FormatString />
            <NullValueString />
          </QuickFormPropertyDataBindingDefinition>
        </DataBindings>
        <ControlLabelPlacement>left</ControlLabelPlacement>
        <ExtendedProperties />
        <CaptionAlignment>left</CaptionAlignment>
        <StyleScheme />
        <OnChangeAction>
          <ResourceKey>dtInspectionEndDate</ResourceKey>
          <Action typeName="Sage.Platform.QuickForms.ActionItems.NoActionActionItem, Sage.Platform.QuickForms">
            <NoActionActionItem>
              <MethodName />
            </NoActionActionItem>
          </Action>
          <IsDialogCloseAction>False</IsDialogCloseAction>
          <RunOnEveryRePaint>False</RunOnEveryRePaint>
          <DialogActionResult>NoResult</DialogActionResult>
          <PerformsUpdate>False</PerformsUpdate>
          <AppliedSecurity />
          <RefreshData>False</RefreshData>
        </OnChangeAction>
        <Required>false</Required>
        <DateTimeValue xsi:nil="true" />
        <SelectedDateTime>0001-01-01T00:00:00</SelectedDateTime>
        <DateOnly>true</DateOnly>
        <DisplayTime>false</DisplayTime>
        <BoundFieldType>DateTime</BoundFieldType>
        <AutoPostBack>false</AutoPostBack>
        <Timeless>false</Timeless>
      </QFDateTimePicker>
    </Control>
    <Control typeName="Sage.Platform.QuickForms.Controls.QFTextBox, Sage.Platform.QuickForms">
      <QFTextBox>
        <Column>1</Column>
        <Row>5</Row>
        <HotKey>0</HotKey>
        <TabIndex>0</TabIndex>
        <ControlId>CUSTOMERPROJECTNO</ControlId>
        <DataBindings>
          <QuickFormPropertyDataBindingDefinition>
            <DataSourceID>MainEntity</DataSourceID>
            <DataItemName>CUSTOMERPROJECTNO</DataItemName>
            <ControlItemName>Text</ControlItemName>
            <FormatString />
            <NullValueString />
          </QuickFormPropertyDataBindingDefinition>
        </DataBindings>
        <ControlLabelPlacement>left</ControlLabelPlacement>
        <ExtendedProperties />
        <CaptionAlignment>left</CaptionAlignment>
        <StyleScheme />
        <MaxLength>64</MaxLength>
        <OnChangeAction>
          <ResourceKey>CUSTOMERPROJECTNO</ResourceKey>
          <Action typeName="Sage.Platform.QuickForms.ActionItems.NoActionActionItem, Sage.Platform.QuickForms">
            <NoActionActionItem>
              <MethodName />
            </NoActionActionItem>
          </Action>
          <IsDialogCloseAction>False</IsDialogCloseAction>
          <RunOnEveryRePaint>False</RunOnEveryRePaint>
          <DialogActionResult>NoResult</DialogActionResult>
          <PerformsUpdate>False</PerformsUpdate>
          <AppliedSecurity />
          <RefreshData>False</RefreshData>
        </OnChangeAction>
        <Required>false</Required>
      </QFTextBox>
    </Control>
    <Control typeName="Sage.SalesLogix.QuickForms.QFControls.QFDateTimePicker, Sage.SalesLogix.QuickForms.QFControls">
      <QFDateTimePicker>
        <Column>1</Column>
        <Row>6</Row>
        <HotKey>0</HotKey>
        <TabIndex>0</TabIndex>
        <ControlId>dtEstimatedClose</ControlId>
        <DataBindings>
          <QuickFormPropertyDataBindingDefinition>
            <DataSourceID>MainEntity</DataSourceID>
            <DataItemName>ESTIMATEDCLOSE</DataItemName>
            <ControlItemName>DateTimeValue</ControlItemName>
            <FormatString />
            <NullValueString />
          </QuickFormPropertyDataBindingDefinition>
        </DataBindings>
        <ControlLabelPlacement>left</ControlLabelPlacement>
        <ExtendedProperties />
        <CaptionAlignment>left</CaptionAlignment>
        <StyleScheme />
        <OnChangeAction>
          <ResourceKey>dtEstimatedClose</ResourceKey>
          <Action typeName="Sage.Platform.QuickForms.ActionItems.NoActionActionItem, Sage.Platform.QuickForms">
            <NoActionActionItem>
              <MethodName />
            </NoActionActionItem>
          </Action>
          <IsDialogCloseAction>False</IsDialogCloseAction>
          <RunOnEveryRePaint>False</RunOnEveryRePaint>
          <DialogActionResult>NoResult</DialogActionResult>
          <PerformsUpdate>False</PerformsUpdate>
          <AppliedSecurity />
          <RefreshData>False</RefreshData>
        </OnChangeAction>
        <Required>false</Required>
        <DateTimeValue xsi:nil="true" />
        <SelectedDateTime>0001-01-01T00:00:00</SelectedDateTime>
        <DateOnly>true</DateOnly>
        <DisplayTime>false</DisplayTime>
        <BoundFieldType>DateTime</BoundFieldType>
        <AutoPostBack>false</AutoPostBack>
        <Timeless>false</Timeless>
      </QFDateTimePicker>
    </Control>
    <Control typeName="Sage.SalesLogix.QuickForms.QFControls.QFSLXPickList, Sage.SalesLogix.QuickForms.QFControls">
      <QFSLXPickList>
        <Column>1</Column>
        <Row>7</Row>
        <HotKey>0</HotKey>
        <TabIndex>0</TabIndex>
        <ControlId>QFSLXPickList1</ControlId>
        <DataBindings>
          <QuickFormPropertyDataBindingDefinition>
            <DataSourceID>MainEntity</DataSourceID>
            <DataItemName>STATUS</DataItemName>
            <ControlItemName>PickListValue</ControlItemName>
            <FormatString />
            <NullValueString />
          </QuickFormPropertyDataBindingDefinition>
        </DataBindings>
        <ControlLabelPlacement>left</ControlLabelPlacement>
        <ExtendedProperties />
        <CaptionAlignment>left</CaptionAlignment>
        <StyleScheme />
        <MaxLength>64</MaxLength>
        <OnChangeAction>
          <ResourceKey>QFSLXPickList1</ResourceKey>
          <Action typeName="Sage.Platform.QuickForms.ActionItems.NoActionActionItem, Sage.Platform.QuickForms">
            <NoActionActionItem>
              <MethodName />
            </NoActionActionItem>
          </Action>
          <IsDialogCloseAction>False</IsDialogCloseAction>
          <RunOnEveryRePaint>False</RunOnEveryRePaint>
          <DialogActionResult>NoResult</DialogActionResult>
          <PerformsUpdate>False</PerformsUpdate>
          <AppliedSecurity />
          <RefreshData>False</RefreshData>
        </OnChangeAction>
        <Required>false</Required>
        <AutoPostBack>false</AutoPostBack>
        <PickListName>Opportunity Status</PickListName>
        <StorageMode>Text</StorageMode>
        <NameFormatString />
        <AllowMultiples>false</AllowMultiples>
        <AlphaSort>false</AlphaSort>
        <MustExistInList>true</MustExistInList>
        <NoneEditable>false</NoneEditable>
        <PickListId />
        <ValueStoredAsText>true</ValueStoredAsText>
      </QFSLXPickList>
    </Control>
    <Control typeName="Sage.Platform.QuickForms.Controls.QFButton, Sage.Platform.QuickForms">
      <QFButton>
        <Column>1</Column>
        <Row>8</Row>
        <Visible>false</Visible>
        <HotKey>0</HotKey>
        <TabIndex>0</TabIndex>
        <ControlId>btnOrder</ControlId>
        <DataBindings />
        <ControlLabelPlacement>none</ControlLabelPlacement>
        <ExtendedProperties />
        <CaptionAlignment>left</CaptionAlignment>
        <StyleScheme />
        <ButtonType>Icon</ButtonType>
        <Image>[Localization!Global_Images:Sales_Order_32x32]</Image>
        <OnClientClick />
        <OnClickAction>
          <ResourceKey>btnOrder</ResourceKey>
          <Action typeName="Sage.Platform.QuickForms.ActionItems.CSharpSnippetActionItem, Sage.Platform.QuickForms">
            <CSharpSnippetActionItem>
              <MethodName />
              <CSharpCodeSnippet>Sage.Platform.WebPortal.EntityPage page = (Sage.Platform.WebPortal.EntityPage)Page;
    Sage.Entity.Interfaces.ISalesOrder objSalesOrder = Sage.Platform.EntityFactory.Create&lt;Sage.Entity.Interfaces.ISalesOrder&gt;();

    //Sage.Entity.Interfaces.ISalesOrderAddress objSalesOrderaddress = Sage.Platform.EntityFactory.Create&lt;Sage.Entity.Interfaces.ISalesOrderAddress&gt;();
    Sage.Platform.Data.IDataService service = Sage.Platform.Application.ApplicationContext.Current.Services.Get&lt;Sage.Platform.Data.IDataService&gt;();
    System.Data.OleDb.OleDbConnection conObj = new System.Data.OleDb.OleDbConnection(service.GetConnectionString());

    Sage.Entity.Interfaces.IQuotation _entity = BindingSource.Current as Sage.Entity.Interfaces.IQuotation;
    if (_entity != null)
    {
		
		  //  objSalesOrderaddress.AddressId  = objSalesOrder.Account.Address.Id.ToString();
         //   objSalesOrderaddress.Save();
		
        objSalesOrder.QuotationId = page.EntityContext.EntityID.ToString();
        Sage.Entity.Interfaces.IAccount Account = Sage.Platform.EntityFactory.GetById&lt;Sage.Entity.Interfaces.IAccount&gt;(_entity.ACCOUNTID);

        Sage.Entity.Interfaces.IOpportunity oppo = Sage.Platform.EntityFactory.GetById&lt;Sage.Entity.Interfaces.IOpportunity&gt;(_entity.OPPORTUNITYID);
        objSalesOrder.Account = Account;
        objSalesOrder.Opportunity = oppo;
        objSalesOrder.IsQuote = false;
		objSalesOrder.Status = "Sales Order";
		objSalesOrder.CurrencyCode = "USD";
objSalesOrder.BranchId =Account.BranchId ;
      
      
		objSalesOrder.OrderType = "Regular Order";
		
        objSalesOrder.Save();
              
        
        
    
        
    }
</CSharpCodeSnippet>
            </CSharpSnippetActionItem>
          </Action>
          <IsDialogCloseAction>False</IsDialogCloseAction>
          <RunOnEveryRePaint>False</RunOnEveryRePaint>
          <DialogActionResult>NoResult</DialogActionResult>
          <PerformsUpdate>False</PerformsUpdate>
          <AppliedSecurity />
          <RefreshData>False</RefreshData>
        </OnClickAction>
      </QFButton>
    </Control>
    <Control typeName="Sage.Platform.QuickForms.Controls.QFButton, Sage.Platform.QuickForms">
      <QFButton>
        <Column>1</Column>
        <Row>10</Row>
        <HotKey>0</HotKey>
        <TabIndex>0</TabIndex>
        <ControlId>btnGenerateOrder</ControlId>
        <DataBindings />
        <ControlLabelPlacement>none</ControlLabelPlacement>
        <ExtendedProperties />
        <CaptionAlignment>left</CaptionAlignment>
        <StyleScheme />
        <ButtonType>StandardButton</ButtonType>
        <Image />
        <OnClientClick />
        <OnClickAction>
          <ResourceKey>btnGenerateOrder</ResourceKey>
          <Action typeName="Sage.Platform.QuickForms.ActionItems.CSharpSnippetActionItem, Sage.Platform.QuickForms">
            <CSharpSnippetActionItem>
              <MethodName>btnGenerateOrder_ClickAction</MethodName>
              <CSharpCodeSnippet> // Generate Order from Quotaion.

    Sage.Platform.WebPortal.EntityPage page = (Sage.Platform.WebPortal.EntityPage)Page;

    Sage.Entity.Interfaces.ISalesOrder objSalesOrder = Sage.Platform.EntityFactory.Create&lt;Sage.Entity.Interfaces.ISalesOrder&gt;();
    Sage.Platform.Data.IDataService service = Sage.Platform.Application.ApplicationContext.Current.Services.Get&lt;Sage.Platform.Data.IDataService&gt;();
    System.Data.OleDb.OleDbConnection conObj = new System.Data.OleDb.OleDbConnection(service.GetConnectionString());

    Sage.Entity.Interfaces.IQuotation _entity = BindingSource.Current as Sage.Entity.Interfaces.IQuotation;
    if (_entity != null)
    {
        try
        {


            objSalesOrder.QuotationId = page.EntityContext.EntityID.ToString();
            Sage.Entity.Interfaces.IAccount Account = Sage.Platform.EntityFactory.GetById&lt;Sage.Entity.Interfaces.IAccount&gt;(_entity.ACCOUNTID);

            Sage.Entity.Interfaces.IOpportunity oppo = Sage.Platform.EntityFactory.GetById&lt;Sage.Entity.Interfaces.IOpportunity&gt;(_entity.OPPORTUNITYID);
            objSalesOrder.Account = Account;
            objSalesOrder.Opportunity = oppo;
            
            objSalesOrder.IsQuote = false;
            objSalesOrder.Status = "Sales Order";
            objSalesOrder.CurrencyCode = oppo.ExchangeRateCode ; // "USD";



           // objSalesOrder.OrderType = "Regular Order";
 
            if (!string.IsNullOrEmpty(_entity.TYPE))
            {
                objSalesOrder.OrderType = _entity.TYPE.ToString();
            }          


            if ((_entity.FEETYPE) != null)
            {
                objSalesOrder.FeeType  = _entity.FEETYPE.ToString();
            }
            if ((_entity.INSPECTIONSTARTDATE) != null)
            {
                objSalesOrder.ProposedStartDate = _entity.INSPECTIONSTARTDATE;
            }
            if ((_entity.INSPECTIONENDDATE ) != null)
            {
                objSalesOrder.ProposedEndDate  = _entity.INSPECTIONENDDATE ;
            }
            if ((_entity.BRANCHID) != null)
            {
                objSalesOrder.BranchId = _entity.BRANCHID.ToString();
            }
      
            if ((_entity.ACCOUNTMANAGERID ) != null)
            {

                Sage.Entity.Interfaces.IUser uf = Sage.Platform.EntityFactory.GetById&lt;Sage.Entity.Interfaces.IUser&gt;(_entity.ACCOUNTMANAGERID);
                objSalesOrder.AccountManager = uf;
                
            }
        
            objSalesOrder.ProjectType = "";   
            
           
            
            if ((_entity.EXCHANGERATE) != null)
            {
                objSalesOrder.ExchangeRate  = Convert.ToDouble (_entity.EXCHANGERATE);
            }

            //datesd

            if ((_entity.ACTUALCLOSE) != null)
            {
                objSalesOrder.DatePromised  = (_entity.ACTUALCLOSE );
            }
          

            if ((_entity.EXCHANGERATEDATE) != null)
            {
                objSalesOrder.ExchangeRateDate  = _entity.EXCHANGERATEDATE;
            }          

          
                    string tbranchid = "0";
            if ((_entity.BRANCHID) != null)
            {
                tbranchid = _entity.BRANCHID.ToString();
            }

            string tBranchcode = "";
            string tQuoteType = "";
            if (!string.IsNullOrEmpty(tbranchid))
            {
                string Query2 = " select Branchcode from branch where branchid='" + tbranchid + "'";
                System.Data.OleDb.OleDbDataAdapter dataAdapterObj2 = new System.Data.OleDb.OleDbDataAdapter(Query2, conObj);
                System.Data.DataTable dt2 = new System.Data.DataTable();

                dataAdapterObj2.Fill(dt2);
                if (dt2.Rows.Count &gt; 0)
                {
                    tBranchcode = dt2.Rows[0][0].ToString();
                }
            }
            string Query = "select yearname,LASTNUMBERUSED  from  sysdba.codemaster where tablename='SalesOrder' and YEARname =YEAR(getdate()) ";

            System.Data.OleDb.OleDbDataAdapter dataAdapterObj = new System.Data.OleDb.OleDbDataAdapter(Query, conObj);
            System.Data.DataTable dt = new System.Data.DataTable();

            dataAdapterObj.Fill(dt);



            string tOrdercode = "";
            int tLastNumber = 0;
            if (!string.IsNullOrEmpty(_entity.TYPE))
            {
                tQuoteType = _entity.TYPE.ToString();
            }

            if (dt.Rows.Count &gt; 0)
            {
                if (String.IsNullOrEmpty(objSalesOrder.Ordercode ))
                {
                    tLastNumber = Convert.ToInt32(dt.Rows[0][1].ToString()) + 1;
                    tOrdercode = tBranchcode + "/" + tQuoteType + "/" + dt.Rows[0][0].ToString() + "/" + tLastNumber;
                    objSalesOrder.Ordercode = tOrdercode;

                }
            }
            else
            {
                //not exist record for year insert new record 

                Sage.Entity.Interfaces.ICodeMaster objcodemaster = Sage.Platform.EntityFactory.Create&lt;Sage.Entity.Interfaces.ICodeMaster&gt;();

                objcodemaster.LastNumberUsed = "0";
                objcodemaster.YearName = Convert.ToString(DateTime.Today.Year);
                objcodemaster.TableName = "SalesOrder";
                objcodemaster.Save();
                string Query1 = "select yearname,LASTNUMBERUSED  from  sysdba.codemaster where  tablename='SalesOrder' and YEARName =YEAR(getdate())";

                System.Data.OleDb.OleDbDataAdapter dataAdapterObj1 = new System.Data.OleDb.OleDbDataAdapter(Query1, conObj);
                System.Data.DataTable dt1 = new System.Data.DataTable();
                dataAdapterObj1.Fill(dt1);
                tLastNumber = Convert.ToInt32(dt1.Rows[0][1].ToString()) + 1;
                tOrdercode = tBranchcode + "/" + tQuoteType + "/" + dt1.Rows[0][0].ToString() + "/" + tLastNumber;
                objSalesOrder.Ordercode = tOrdercode;

            }

            objSalesOrder.Save();

            //*************************  Quotation product *******************

            Sage.Entity.Interfaces.ISalesOrderItem objSalesOrderItem = Sage.Platform.EntityFactory.Create&lt;Sage.Entity.Interfaces.ISalesOrderItem&gt;();

            string QryProduct = "select  * from Quotation_PRODUCT where quotationid ='" + page.EntityContext.EntityID.ToString() + "'";

            System.Data.OleDb.OleDbDataAdapter da = new System.Data.OleDb.OleDbDataAdapter(QryProduct, conObj);
            System.Data.DataTable dtproduct = new System.Data.DataTable();
            da.Fill(dtproduct);
            if (dtproduct.Rows.Count &gt; 0)
            {

                for (int i = 0; i &lt;= dtproduct.Rows.Count - 1; i++)
                {

                    //'objSalesOrderItem.PRODUCTID = !string.IsNullOrEmpty(dtproduct.Rows[i][2].ToString()) ? dtproduct.Rows[i][2].ToString() : string.Empty;
                    Sage.Entity.Interfaces.ISalesOrder  SalesOrder = Sage.Platform.EntityFactory.GetById&lt;Sage.Entity.Interfaces.ISalesOrder&gt;(objSalesOrder.Id.ToString());
                    objSalesOrderItem.SalesOrder = SalesOrder;
                    Sage.Entity.Interfaces.IProduct product = Sage.Platform.EntityFactory.GetById&lt;Sage.Entity.Interfaces.IProduct&gt;(dtproduct.Rows[i][6].ToString());
                    objSalesOrderItem.SalesOrder = SalesOrder;
                    
                    
				  if (!string.IsNullOrEmpty(dtproduct.Rows[i][6].ToString()))
                    {
                        objSalesOrderItem.Product = product;
                        objSalesOrderItem.Family = product.Family;
                        objSalesOrderItem.ProductName = product.Name;
                        objSalesOrderItem.UnitOfMeasure = product.UnitOfMeasure;
                      
                      
                    }
                    if (!string.IsNullOrEmpty(dtproduct.Rows[i][7].ToString()))
                    {
                        objSalesOrderItem.Quantity = Convert.ToDouble(dtproduct.Rows[i][7].ToString());
                    }
                    if (!string.IsNullOrEmpty(dtproduct.Rows[i][8].ToString()))
                    {
                        objSalesOrderItem.Discount = Convert.ToDouble(dtproduct.Rows[i][8].ToString());
                    }
                    if (!string.IsNullOrEmpty(dtproduct.Rows[i][9].ToString()))
                    {

                        objSalesOrderItem.Price = Convert.ToDouble(dtproduct.Rows[i][9].ToString());
                    }
                    
                    if (!string.IsNullOrEmpty(dtproduct.Rows[i][11].ToString()))
                    {
                        objSalesOrderItem.ExtendedPrice = Convert.ToDouble(dtproduct.Rows[i][11].ToString());
                    }
                    
                    if (!string.IsNullOrEmpty(dtproduct.Rows[i][13].ToString()))
                    {
                        objSalesOrderItem. CalculatedPrice  = Convert.ToDecimal(dtproduct.Rows[i][13].ToString());
                    }
                    if (!string.IsNullOrEmpty(dtproduct.Rows[i][14].ToString()))
                    {
                       // objSalesOrderItem.UnitOfMeasure  = dtproduct.Rows[i][14].ToString();
                    }
                    if (!string.IsNullOrEmpty(dtproduct.Rows[i][15].ToString()))
                    {
                        objSalesOrderItem.Program  = dtproduct.Rows[i][15].ToString();
                    }

                    if (!string.IsNullOrEmpty(dtproduct.Rows[i][21].ToString()))
                    {
                        objSalesOrderItem.LineNumber  = Convert.ToInt32 (dtproduct.Rows[i][21].ToString());
                    }              
                    if (!string.IsNullOrEmpty(dtproduct.Rows[i][22].ToString()))
                    {
                        objSalesOrderItem.CreateSource  = dtproduct.Rows[i][22].ToString();
                    }
                       
                     
                    objSalesOrderItem.Save();

                }

            }

            //'*********** quotation contact



            Sage.Entity.Interfaces.IQuotationContact objQuotationcontact = Sage.Platform.EntityFactory.Create&lt;Sage.Entity.Interfaces.IQuotationContact&gt;();
         
            
            string Qrycontact = "select  * from Quotation_CONTACT where IsPrimary='T' and quotationid ='" + page.EntityContext.EntityID.ToString() + "'";

            System.Data.OleDb.OleDbDataAdapter dacontact = new System.Data.OleDb.OleDbDataAdapter(Qrycontact, conObj);
            System.Data.DataTable dtcontact = new System.Data.DataTable();
            dacontact.Fill(dtcontact);
            if (dtcontact.Rows.Count &gt; 0)
            {

                for (int i = 0; i &lt;= dtcontact.Rows.Count - 1; i++)
                {

                    //'objQuotationProduct.PRODUCTID = !string.IsNullOrEmpty(dtproduct.Rows[i][2].ToString()) ? dtproduct.Rows[i][2].ToString() : string.Empty;


                    if (!string.IsNullOrEmpty(dtcontact.Rows[i][1].ToString()))
                    {
                       // objQuotationcontact.CONTACTID = dtcontact.Rows[i][1].ToString();

                         Sage.Entity.Interfaces.IContact  contact = Sage.Platform.EntityFactory.GetById&lt;Sage.Entity.Interfaces.IContact &gt;( dtcontact.Rows[i][1].ToString());
                         objSalesOrder.RequestedBy = contact;
            
                   
                    }
                        

                    
                }
            }



            //***** fee structure *** OPPORTUNITYFEESTRUCTURE

            Sage.Entity.Interfaces.ISalesOrderFeeStructure objSalesOrderfee = Sage.Platform.EntityFactory.Create&lt;Sage.Entity.Interfaces.ISalesOrderFeeStructure&gt;();

            string Qryfee = "select  * from QUOTATION_FEESTRUCTURE where quotationid ='" + page.EntityContext.EntityID.ToString() + "'";

            System.Data.OleDb.OleDbDataAdapter dafee = new System.Data.OleDb.OleDbDataAdapter(Qryfee, conObj);
            System.Data.DataTable dtfee = new System.Data.DataTable();
            dafee.Fill(dtfee);
            if (dtfee.Rows.Count &gt; 0)
            {

                for (int i = 0; i &lt;= dtfee.Rows.Count - 1; i++)
                {

                    //'objQuotationProduct.PRODUCTID = !string.IsNullOrEmpty(dtproduct.Rows[i][2].ToString()) ? dtproduct.Rows[i][2].ToString() : string.Empty;

                    objSalesOrderfee.SalesOrderId = objSalesOrder.Id.ToString();
                    if (!string.IsNullOrEmpty(dtfee.Rows[i][6].ToString()))
                    {
                        objSalesOrderfee.Description = dtfee.Rows[i][6].ToString();
                    }

                    objSalesOrderfee.Save();
                }
            }

           
            
            //**** payment terms


            Sage.Entity.Interfaces.ISalesOrderPaymentTerm objsalesorderpayment = Sage.Platform.EntityFactory.Create&lt;Sage.Entity.Interfaces.ISalesOrderPaymentTerm&gt;();

            string Qrypayment = "select  * from Quotation_PAYMENTTERM where quotationid ='" + page.EntityContext.EntityID.ToString() + "'";

            System.Data.OleDb.OleDbDataAdapter dapayment = new System.Data.OleDb.OleDbDataAdapter(Qrypayment, conObj);
            System.Data.DataTable dtpayment = new System.Data.DataTable();
            dapayment.Fill(dtpayment);
            if (dtpayment.Rows.Count &gt; 0)
            {

                for (int i = 0; i &lt;= dtpayment.Rows.Count - 1; i++)
                {



                    objsalesorderpayment.SalesOrderId = objSalesOrder.Id.ToString();
                    if (!string.IsNullOrEmpty(dtpayment.Rows[i][6].ToString()))
                    {
                        objsalesorderpayment.Description = dtpayment.Rows[i][6].ToString();
                    }

                    objsalesorderpayment.Save();
                }
            } 


            
            //update codemaster
            string tno = "0";
            if (!string.IsNullOrEmpty(objSalesOrder.Ordercode .ToString()))
            {
                tno = objSalesOrder.Ordercode.ToString();
                string[] tno1 = tno.Split('/');

                tno = tno1[3];

                System.Data.OleDb.OleDbConnection conObj1 = new System.Data.OleDb.OleDbConnection(service.GetConnectionString());
                conObj1.Open();
                string query1 = "Update sysdba.codemaster set LASTNUMBERUSED ='" + tno + "' where tablename='SalesOrder' and  yearname=YEAR(getdate())";
                System.Data.OleDb.OleDbCommand cmd = new System.Data.OleDb.OleDbCommand(query1, conObj1);
                cmd.ExecuteNonQuery();

            }


            Response.Redirect(string.Format("SalesOrder.aspx?entityId=" + objSalesOrder.Id.ToString(), "&amp;modeid=Detail"));
        }
        catch (Exception ex)
        {
            throw ex;
        }
        finally
        {
            conObj.Dispose();
        }

    }

</CSharpCodeSnippet>
            </CSharpSnippetActionItem>
          </Action>
          <IsDialogCloseAction>False</IsDialogCloseAction>
          <RunOnEveryRePaint>False</RunOnEveryRePaint>
          <DialogActionResult>NoResult</DialogActionResult>
          <PerformsUpdate>False</PerformsUpdate>
          <AppliedSecurity />
          <RefreshData>False</RefreshData>
        </OnClickAction>
      </QFButton>
    </Control>
  </Controls>
  <ToolControls>
    <Control typeName="Sage.Platform.QuickForms.Controls.QFElementSpacer, Sage.Platform.QuickForms">
      <QFElementSpacer>
        <Column>0</Column>
        <Row>0</Row>
        <HotKey>0</HotKey>
        <TabIndex>0</TabIndex>
        <ControlId>f5ddba7e630648079fbb0451119b1bf1</ControlId>
        <DataBindings />
        <ControlLabelPlacement>left</ControlLabelPlacement>
        <ExtendedProperties />
        <CaptionAlignment>left</CaptionAlignment>
        <StyleScheme />
      </QFElementSpacer>
    </Control>
    <Control typeName="Sage.Platform.QuickForms.Controls.QFElementSpacer, Sage.Platform.QuickForms">
      <QFElementSpacer>
        <Column>0</Column>
        <Row>0</Row>
        <HotKey>0</HotKey>
        <TabIndex>0</TabIndex>
        <ControlId>a60b0f2b05c4052914a173688b5293c</ControlId>
        <DataBindings />
        <ControlLabelPlacement>left</ControlLabelPlacement>
        <ExtendedProperties />
        <CaptionAlignment>left</CaptionAlignment>
        <StyleScheme />
      </QFElementSpacer>
    </Control>
    <Control typeName="Sage.SalesLogix.QuickForms.QFControls.QFSLXGroupNavigator, Sage.SalesLogix.QuickForms.QFControls">
      <QFSLXGroupNavigator>
        <Column>0</Column>
        <Row>0</Row>
        <HotKey>48</HotKey>
        <TabIndex>0</TabIndex>
        <ControlId>grpNavigator</ControlId>
        <DataBindings />
        <ControlLabelPlacement>none</ControlLabelPlacement>
        <ExtendedProperties />
        <CaptionAlignment>left</CaptionAlignment>
        <StyleScheme />
      </QFSLXGroupNavigator>
    </Control>
    <Control typeName="Sage.Platform.QuickForms.Controls.QFButton, Sage.Platform.QuickForms">
      <QFButton>
        <Column>0</Column>
        <Row>0</Row>
        <HotKey>0</HotKey>
        <TabIndex>0</TabIndex>
        <ControlId>btnSave</ControlId>
        <DataBindings />
        <ControlLabelPlacement>none</ControlLabelPlacement>
        <ExtendedProperties />
        <CaptionAlignment>left</CaptionAlignment>
        <StyleScheme />
        <ButtonType>Icon</ButtonType>
        <Image>[Localization!Global_Images:Save_16x16]</Image>
        <OnClientClick />
        <OnClickAction>
          <ResourceKey>btnSave</ResourceKey>
          <Action typeName="Sage.Platform.QuickForms.ActionItems.BusinessRuleActionItem, Sage.Platform.QuickForms">
            <BusinessRuleActionItem>
              <BusinessRule>Save</BusinessRule>
              <Object>Quotation</Object>
              <Parameters />
              <PassResultsToNextAction>False</PassResultsToNextAction>
              <OnComplete typeName="Sage.Platform.QuickForms.ActionItems.NoActionActionItem, Sage.Platform.QuickForms">
                <NoActionActionItem>
                  <MethodName />
                </NoActionActionItem>
              </OnComplete>
            </BusinessRuleActionItem>
          </Action>
          <IsDialogCloseAction>False</IsDialogCloseAction>
          <RunOnEveryRePaint>False</RunOnEveryRePaint>
          <DialogActionResult>NoResult</DialogActionResult>
          <PerformsUpdate>True</PerformsUpdate>
          <AppliedSecurity />
          <RefreshData>False</RefreshData>
        </OnClickAction>
      </QFButton>
    </Control>
    <Control typeName="Sage.Platform.QuickForms.Controls.QFButton, Sage.Platform.QuickForms">
      <QFButton>
        <Column>0</Column>
        <Row>0</Row>
        <HotKey>0</HotKey>
        <TabIndex>0</TabIndex>
        <ControlId>btnDelete</ControlId>
        <DataBindings />
        <ControlLabelPlacement>none</ControlLabelPlacement>
        <ExtendedProperties />
        <CaptionAlignment>left</CaptionAlignment>
        <StyleScheme />
        <ButtonType>Icon</ButtonType>
        <Image>[Localization!Global_Images:Delete_16x16]</Image>
        <OnClientClick />
        <OnClickAction>
          <ResourceKey>btnDelete</ResourceKey>
          <Action typeName="Sage.Platform.QuickForms.ActionItems.BusinessRuleActionItem, Sage.Platform.QuickForms">
            <BusinessRuleActionItem>
              <BusinessRule>Delete</BusinessRule>
              <Object>Quotation</Object>
              <Parameters />
              <PassResultsToNextAction>False</PassResultsToNextAction>
              <OnComplete typeName="Sage.Platform.QuickForms.ActionItems.NoActionActionItem, Sage.Platform.QuickForms">
                <NoActionActionItem>
                  <MethodName />
                </NoActionActionItem>
              </OnComplete>
            </BusinessRuleActionItem>
          </Action>
          <IsDialogCloseAction>False</IsDialogCloseAction>
          <RunOnEveryRePaint>False</RunOnEveryRePaint>
          <DialogActionResult>NoResult</DialogActionResult>
          <PerformsUpdate>False</PerformsUpdate>
          <AppliedSecurity />
          <RefreshData>False</RefreshData>
        </OnClickAction>
      </QFButton>
    </Control>
  </ToolControls>
  <Columns>
    <ColumnStyle>
      <SizeType>Percent</SizeType>
      <Width>50</Width>
    </ColumnStyle>
    <ColumnStyle>
      <SizeType>Percent</SizeType>
      <Width>50</Width>
    </ColumnStyle>
  </Columns>
  <Rows>
    <RowStyle>
      <SizeType>Absolute</SizeType>
      <Height>35</Height>
    </RowStyle>
    <RowStyle>
      <SizeType>Absolute</SizeType>
      <Height>35</Height>
    </RowStyle>
    <RowStyle>
      <SizeType>Absolute</SizeType>
      <Height>35</Height>
    </RowStyle>
    <RowStyle>
      <SizeType>Absolute</SizeType>
      <Height>35</Height>
    </RowStyle>
    <RowStyle>
      <SizeType>Absolute</SizeType>
      <Height>35</Height>
    </RowStyle>
    <RowStyle>
      <SizeType>Absolute</SizeType>
      <Height>35</Height>
    </RowStyle>
    <RowStyle>
      <SizeType>Absolute</SizeType>
      <Height>35</Height>
    </RowStyle>
    <RowStyle>
      <SizeType>Absolute</SizeType>
      <Height>35</Height>
    </RowStyle>
    <RowStyle>
      <SizeType>Absolute</SizeType>
      <Height>35</Height>
    </RowStyle>
    <RowStyle>
      <SizeType>Absolute</SizeType>
      <Height>35</Height>
    </RowStyle>
    <RowStyle>
      <SizeType>Absolute</SizeType>
      <Height>35</Height>
    </RowStyle>
  </Rows>
  <Description />
  <UseEntityNameAsTitle>true</UseEntityNameAsTitle>
  <EntityTypeName>IQuotation</EntityTypeName>
  <DefaultNamespace>Sage.Entity.Interfaces</DefaultNamespace>
  <AssemblyName>Sage.Entity.Interfaces</AssemblyName>
</QuickForm>